{% extends "base.html" %}
{% block title %}Quản lý câu hỏi{% endblock %}

{% block content %}
<h2 class="mb-4">Quản lý câu hỏi – {{ quiz.title }}</h2>

<form method="POST" class="card p-4 mb-4">

    <div class="mb-3">
        <label class="form-label">Nội dung câu hỏi</label>
        <textarea name="content" class="form-control" rows="3" required></textarea>
    </div>

    <div class="mb-3">
        <label class="form-label">Loại câu hỏi</label>
        <select name="type" class="form-select" required>
            <option value="mcq">Trắc nghiệm</option>
            <option value="true_false">Đúng/Sai</option>
            <option value="essay">Tự luận</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Giải thích (optional)</label>
        <textarea name="explanation" class="form-control" rows="2"></textarea>
    </div>

    <div class="mb-3">
        <label class="form-label">Độ khó</label>
        <select name="difficulty" class="form-select">
            <option value="">--Chọn--</option>
            <option value="easy">Dễ</option>
            <option value="medium">Trung bình</option>
            <option value="hard">Khó</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Thời gian cho câu (giây)</label>
        <input type="number" name="time_limit" class="form-control">
    </div>

    <hr class="my-3">

    <h5>Đáp án (chỉ dùng cho trắc nghiệm):</h5>

    {% for i in range(1, 5) %}
    <div class="mb-3">
        <label class="form-label">Lựa chọn {{ i }}</label>
        <div class="input-group">
            <input type="text" name="choice_{{ i }}" class="form-control">
            <div class="input-group-text">
                <input type="radio" name="correct_choice" value="{{ i }}">
            </div>
        </div>
    </div>
    {% endfor %}

    <button type="submit" class="btn btn-primary-soft">Thêm câu hỏi</button>
</form>

<hr>

<h4>Danh sách câu hỏi</h4>
<table class="table table-dark-soft table-bordered mt-3">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nội dung</th>
            <th>Loại</th>
            <th>Độ khó</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for q in questions %}
        <tr>
            <td>{{ q.id }}</td>
            <td style="max-width: 300px">{{ q.content }}</td>
            <td>{{ q.type }}</td>
            <td>{{ q.difficulty or '-' }}</td>
            <td>
              <a href="{{ url_for('quiz.edit_question', question_id=q.id) }}"
                  class="btn btn-outline-soft btn-sm">
                    Sửa</a>

                  <form method="POST"
                  action="{{ url_for('quiz.delete_question', question_id=q.id) }}"
                  style="display:inline;"
                  onsubmit="return confirm('Xóa câu hỏi này?');">

                  <button class="btn btn-outline-soft btn-sm text-danger">
                    Xóa
                  </button>
              </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
