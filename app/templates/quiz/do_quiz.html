{% extends "base.html" %}

{% block title %}Làm Quiz | {{ quiz.title }}{% endblock %}

{% block content %}
<div class="card-soft p-3 p-md-4 mb-3">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-2">
        <div>
            <h3 class="page-title mb-1">{{ quiz.title }}</h3>
            <p class="page-subtitle mb-0">
                {{ quiz.description or "Cố gắng đừng đoán mò quá nhiều." }}
            </p>
        </div>
        <div class="text-md-end">
            <div class="small text-muted">
                Thời gian: {{ quiz.time_limit or "Không giới hạn" }} phút
            </div>
            <div class="small text-muted">
                Số câu: {{ questions|length }}
            </div>
        </div>
    </div>
</div>

<form method="post">
    {% for q in questions %}
    <div class="quiz-card p-3 mb-3">
        <div class="d-flex justify-content-between align-items-center mb-1">
            <span class="text-info fw-semibold">Câu {{ loop.index }}</span>
            <span class="small text-muted text-uppercase">
                {% if q.type == "mcq" %}Multiple Choice{% elif q.type == "true_false" %}True / False{% else %}Essay{% endif %}
            </span>
        </div>
        <p class="mb-2">{{ q.content }}</p>

        {% if q.type == "mcq" or q.type == "true_false" %}
            {% for c in q.choices %}
            <label class="answer-option">
                <input
                    class="form-check-input"
                    type="radio"
                    name="q_{{ q.id }}"
                    value="{{ c.id }}"
                    style="margin-top: 0;"
                />
                <span>{{ c.content }}</span>
            </label>
            {% endfor %}
        {% elif q.type == "essay" %}
            <textarea class="form-control" name="q_{{ q.id }}" rows="4"
                      placeholder="Nhập câu trả lời của bạn tại đây..."></textarea>
        {% endif %}

        {% if q.explanation %}
        <small class="text-muted d-block mt-1">
            * Câu hỏi có giải thích sau khi nộp bài.
        </small>
        {% endif %}
    </div>
    {% endfor %}

    <div class="d-flex justify-content-end">
        <button type="submit" class="btn btn-primary-soft px-4">
            ✅ Nộp bài
        </button>
    </div>
</form>
{% endblock %}
